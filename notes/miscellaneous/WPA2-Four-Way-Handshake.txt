
# WPA/WPA2 4-way Handshake

## Overview

The 4-way handshake is the process of exchanging 4 messages between an access point (authenticator) and the client device (supplicant) to generate some encryption keys which can be used to encrypt actual data sent over Wireless medium


MSK (Master Session Key)
- Encrypt all unicast traffic between client and AP
- Unique between client/AP
- PTK = PRF (PMK + Anonce + SNonce + Mac (AA)+ Mac (SA))

Anonce is a random number generated by an access point (authenticator), Snonce a random number generated by the client device (supplicant). MAC addresses of supplicant (client device) and MAC address of authenticator (access point). PRF is a pseudo-random function which is applied to all the input.

- PMK (Pairwise Master Key)
- GMK (Group Master Key)
- PTK (Pairwise Transit Key)
- GTK (Group Temporal Key)
- ANonce -  random number generated by an access point (authenticator)
- SNonce  - Snonce a random number generated by the client device (supplicant)
- MIC

Source: https://www.wifi-professionals.com/2019/01/4-way-handshake
